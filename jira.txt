updatePrompt() {
    const selected = this.missingTools
      .filter(x => x.selected)
      .map(x => x.req.tool);

    if (selected.length === 0) {
      this.allyString = "";
      return;
    }

    const toolList = selected.map(s => `â€¢ ${s}`).join('\n');
    const empLabel = `${this.data.employeeName} (${this.data.employeeId})`;

    // Check if buddy exists AND is not "N/A"
    const hasValidBuddy = this.buddyName && this.buddyName.trim().toUpperCase() !== 'N/A';

    if (hasValidBuddy) {
      // WITH BUDDY (Mirroring)
      if (this.data.isManager) {
        this.allyString = `Hi Ally,\nPlease grant access for ${empLabel} for Project "${this.projectName}".\nPlease mirror the access rights of their buddy, ${this.buddyName}.\n\nRequired Tools:\n${toolList}\n\nRef: Manager Override`;
      } else {
        this.allyString = `Hi Ally,\nI am working on Project "${this.projectName}".\nPlease grant me the same access rights as my buddy, ${this.buddyName}.\n\nRequired Tools:\n${toolList}\n\nRef: Onboarding Mirroring`;
      }
    } else {
      // WITHOUT BUDDY (Standard Request)
      if (this.data.isManager) {
        this.allyString = `Hi Ally,\nPlease provision the necessary project access for ${empLabel}.\nThey are joining Project "${this.projectName}".\n\nRequired Tools:\n${toolList}\n\nRef: New Hire Provisioning`;
      } else {
        this.allyString = `Hi Ally,\nI have joined Project "${this.projectName}".\nPlease grant me access to the required environment tools.\n\nRequired Tools:\n${toolList}\n\nRef: Access Request`;
      }
    }
  }
